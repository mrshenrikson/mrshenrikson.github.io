<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Virtuelles Klavier mit Akkord-Samples</title>
<style>
  body{font-family:sans-serif;margin:0;background:#f7f7fb}
  h1{font-size:20px;margin:14px}
  .controls{display:flex;gap:10px;align-items:center;margin:0 14px 8px}
  .btn{background:#222;color:#fff;border:none;border-radius:8px;padding:10px 14px}
  .label{padding:6px 10px;border-radius:8px;background:#e9eefb;font-weight:600}
  .piano{padding:12px;background:#ececf4;border-radius:12px;border:1px solid #ccc}
  .row{display:flex;gap:6px}
  .key{width:50px;height:120px;display:flex;align-items:flex-end;justify-content:center;font-weight:bold;border:1px solid #333;border-radius:6px}
  .white{background:#fff;color:#000}
  .black{background:#000;color:#fff;width:36px;height:80px;margin-left:-18px;margin-right:-18px;z-index:1;position:relative}
  .active{background:#5ea0ff!important;color:#000!important}
  .chord{outline:3px solid orange;outline-offset:-3px}
</style>
</head>
<body>
<h1>ðŸŽ¹ Virtuelles Klavier (mit Dreiklang-Samples)</h1>

<div class="controls">
  <label><input id="minor" type="checkbox"> Moll-DreiklÃ¤nge</label>
  <button id="probe" class="btn">ðŸ”Š Probe</button>
</div>

<div class="piano">
  <div class="row">
    <button class="key white" data-note="C1">C</button>
    <button class="key black" data-note="C1s">C#</button>
    <button class="key white" data-note="D1">D</button>
    <button class="key black" data-note="D1s">D#</button>
    <button class="key white" data-note="E1">E</button>
    <button class="key white" data-note="F1">F</button>
    <button class="key black" data-note="F1s">F#</button>
    <button class="key white" data-note="G1">G</button>
    <button class="key black" data-note="G1s">G#</button>
    <button class="key white" data-note="A1">A</button>
    <button class="key black" data-note="A1s">A#</button>
    <button class="key white" data-note="B1">B</button>

    <button class="key white" data-note="C2">C</button>
    <button class="key black" data-note="C2s">C#</button>
    <button class="key white" data-note="D2">D</button>
    <button class="key black" data-note="D2s">D#</button>
    <button class="key white" data-note="E2">E</button>
    <button class="key white" data-note="F2">F</button>
    <button class="key black" data-note="F2s">F#</button>
    <button class="key white" data-note="G2">G</button>
    <button class="key black" data-note="G2s">G#</button>
    <button class="key white" data-note="A2">A</button>
    <button class="key black" data-note="A2s">A#</button>
    <button class="key white" data-note="B2">B</button>
  </div>
</div>

<script>
const BASE = '/samples/';
const EXT = 'm4a';

function playSample(file, duration=0){
  const audio = new Audio(BASE + file + '.' + EXT);
  audio.play().catch(()=>{});
  if(duration>0){
    setTimeout(()=>{audio.pause(); audio.remove();}, duration*1000);
  }
}

document.querySelectorAll('.key').forEach(k=>{
  k.addEventListener('click', ()=>{
    const note = k.dataset.note;
    const minor = document.getElementById('minor').checked;
    // 1) Einzeltton
    playSample(note, 2);
    // 2) Pause, dann Akkord
    setTimeout(()=>{
      const chordFile = note + (minor ? "_moll" : "_dur");
      playSample(chordFile, 3);
    }, 3000); // 2s Ton + 1s Pause
  });
});

document.getElementById('probe').addEventListener('click',()=>{
  playSample('C1',1.5);
});
</script>
</body>
</html>
