<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Mein Klavier â€“ Oktave (C1..C3) mit Umschalter</title>
<style>
  :root{ --wW:64px; --bW:46px; --wH:140px; --bH:90px; --gap:6px; --mark:#f6b73c; }
  *{box-sizing:border-box}
  body{margin:0;font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:#f7f7fb;color:#111}
  h1{font-size:20px;margin:14px}
  .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:0 14px 8px}
  .btn{background:#222;color:#fff;border:none;border-radius:8px;padding:10px 14px;touch-action:manipulation}
  .btn:disabled{opacity:.6}
  .label{padding:6px 10px;border-radius:8px;background:#e9eefb;font-weight:600}
  .board{padding:12px}
  .piano{overflow-x:auto;-webkit-overflow-scrolling:touch;border:1px solid #ddd;border-radius:12px;background:#ececf4;padding:12px}
  .row{display:flex;gap:var(--gap);align-items:flex-end;min-width:calc(7*var(--wW)+6*var(--gap))}
  .row+.row{margin-top:8px}
  .key{display:inline-flex;align-items:flex-end;justify-content:center;font-weight:600;font-size:14px;border-radius:8px;user-select:none;touch-action:manipulation}
  .white{width:var(--wW);height:var(--wH);background:#fff;border:2px solid #333;color:#111}
  .black{width:var(--bW);height:var(--bH);background:#1b1b1b;border:2px solid #000;color:#fff}
  .spacer{width:var(--wW)}
  .active{background:linear-gradient(#a6c8ff,#5ea0ff)!important;color:#000!important}
  .chord{outline:3px solid var(--mark);outline-offset:-3px}
  footer{padding:0 14px 18px;color:#666;font-size:13px}
</style>
</head>
<body>
<h1>ðŸŽ¹ Mein Klavier (eine Oktave, umschaltbar C1â†”C2â†”C3)</h1>

<div class="controls">
  <button id="prevOct" class="btn" title="vorige Oktave">âŸµ</button>
  <span id="octLabel" class="label">Oktave: C1</span>
  <button id="nextOct" class="btn" title="nÃ¤chste Oktave">âŸ¶</button>
  <label style="margin-left:8px;"><input id="minor" type="checkbox"> Moll-DreiklÃ¤nge</label>
</div>

<div class="board">
  <div class="piano" id="piano">
    <!-- Reihe 1: schwarze Tasten -->
    <div class="row" id="rowBlack">
      <div class="spacer"></div>
      <button class="key black" data-semi="1">C#</button>
      <button class="key black" data-semi="3">D#</button>
      <div class="spacer"></div>
      <button class="key black" data-semi="6">F#</button>
      <button class="key black" data-semi="8">G#</button>
      <button class="key black" data-semi="10">A#</button>
      <div class="spacer"></div>
    </div>
    <!-- Reihe 2: weiÃŸe Tasten -->
    <div class="row" id="rowWhite">
      <button class="key white" data-semi="0">C</button>
      <button class="key white" data-semi="2">D</button>
      <button class="key white" data-semi="4">E</button>
      <button class="key white" data-semi="5">F</button>
      <button class="key white" data-semi="7">G</button>
      <button class="key white" data-semi="9">A</button>
      <button class="key white" data-semi="11">B</button>
    </div>
  </div>
</div>

<footer>
  Tipp auf eine Taste: 2 s Einzeltton â†’ 1 s Pause â†’ 3 s Dreiklang (Grundstellung; Dur/Moll schaltbar).  
  Leise bis moderat Ã¼ben; bei Kratzen â†’ Pause. ðŸ’™
</footer>

<script>
(()=>{
/* â€”â€”â€” Einstellungen â€”â€”â€” */
const LOWEST_OCT = 1;   // C1
const HIGHEST_OCT = 3;  // C3
let currentOct = 1;     // Startansicht: C1

// FÃ¼r User-Site passt '/'.
// Wenn dein Code in einem Unterordner (Projektseite) liegt, z.B. /klavier/, setze BASE = '/klavier/'
const BASE = '/';

// Deine Dateien sind .m4a
const EXT = 'm4a';

/* â€”â€”â€” Namen / Filenamen â€”â€”â€” */
const NAMES = ['C','Cs','D','Ds','E','F','Fs','G','Gs','A','As','B'];
function noteName(oct, semi){ return NAMES[semi] + oct; } // "Fs2"

/* â€”â€”â€” Audio-Sample-Player (HTMLAudio, .m4a) â€”â€”â€” */
const cache = new Map(); // "C2" -> HTMLAudio master
function getAudio(note){
  const key = note.toUpperCase();
  if(!cache.has(key)){
    const a = new Audio(`${BASE}samples/${key}.${EXT}`);
    a.preload = 'auto';
    cache.set(key, a);
  }
  return cache.get(key).cloneNode(true); // fÃ¼r paralleles Abspielen
}
function playSample(note, durSec=2.
